# ---
# - name: Create Node Exporter install directory
#   ansible.builtin.file:
#     path: "{{ node_exporter_install_dir }}"
#     state: directory
#     owner: beaprom
#     group: beaprom
#     mode: "0755"
# - name: Download Node Exporter
#   ansible.builtin.get_url:
#     url: "{{ node_exporter_download_url }}"
#     dest: "{{ node_exporter_install_dir }}/{{ node_exporter_version }}.tar.gz"
#     owner: beaprom
#     group: beaprom
#     mode: "0644"
# - name: Extract Node Exporter
#   ansible.builtin.unarchive:
#     src: "{{ node_exporter_install_dir }}/{{ node_exporter_version }}.tar.gz"
#     dest: "{{ node_exporter_install_dir }}"
#     remote_src: yes
#     owner: beaprom
#     group: beaprom
# - name: Create Node Exporter service file
#   ansible.builtin.template:
#     src: node_exporter.service.j2
#     dest: "/home/beaprom/.config/systemd/user/node_exporter.service"
#     owner: beaprom
#     group: beaprom
#     mode: "0644"
# - name: Reload systemd daemon for user services
#   ansible.builtin.command: systemctl --user daemon-reload
#   changed_when: false
# - name: Enable and start Node Exporter service
#   ansible.builtin.systemd_service:
#     scope: user
#     name: node_exporter.service
#     state: started
#     enabled: yes
# - name: Verify Node Exporter endpoint
#   ansible.builtin.uri:
#     url: "http://localhost:{{ node_exporter_port }}/metrics"
#     method: GET
#     status_code: 200
#   become: yes
